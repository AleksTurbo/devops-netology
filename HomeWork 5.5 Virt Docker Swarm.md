# Домашнее задание к занятию "5.5. Оркестрация кластером Docker контейнеров на примере Docker Swarm"

## Задача 1

- В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?

```txt
Replicated  - сервис запускается в количестве экземпляров указанных при создании роя. При этом на отдельной
ноде может быть как несколько экземпляров приложения, так и не быть совсем (пример - сервис визуализации Grafana).

Global - сервис разворачивается обязательно на каждой ноде и в единственном экземпляре (например - сборщик метрик nodeexporter).
```

- Какой алгоритм выбора лидера используется в Docker Swarm кластере?

```txt
Механизм - Raft: решает проблему согласованности - чтобы все manager-ноды имели одинаковое представление о состоянии кластера
Лидер нода выбирается из управляючих нод путем Raft согласованного алгоритма. 
Лидер отправляет keepalive-пакеты с заданной периодичностью в пределах 150-300мс. 
Если пакеты не пришли, менеджеры начинают выборы нового лидера.
Сам Raft-алгоритм имеет ограничение на количество управляющих нод. 
Распределенные решения должны быть одобрены большинством управляющих узлов, называемых кворумом. 
Это означает, что рекомендуется нечетное количество управляющих узлов. 
Если кластер разбит, нечётное количество нод должно гарантировать, что кластер останется консистентным
```

- Что такое Overlay Network?

```txt
Overlay-сеть создает подсеть, которую могут использовать контейнеры в разных хостах swarm-кластера. 
Контейнеры на разных физических хостах могут обмениваться данными по overlay-сети (если все они прикреплены к одной сети). 
Overlay-сеть использует технологию vxlan, которая инкапсулирует layer 2 фреймы в layer 4 пакеты (UDP/IP). 
При помощи этого действия Docker создает виртуальные сети поверх существующих связей между хостами, которые могут оказаться внутри одной подсети. 
Любые точки, которые являются частью этой виртуальной сети, выглядят друг для друга так, будто они связаны поверх свича и 
не заботятся об устройстве основной физической сети. 
vxlan использует udp port 4789.
```

## Задача 2

Создаем Docker Swarm кластер в Яндекс.Облаке:

![YC node 1 VM](https://github.com/AleksTurbo/devops-netology/blob/main/YC%20node%201%20VM.png "YC node 1 VM")

## Задача 3

Создаем кластер мониторинга, состоящий из стека микросервисов:
![Grafana metrics node1](https://github.com/AleksTurbo/devops-netology/blob/main/Grafana%20metrics%20node1.png "Grafana metrics node1")

## Задача 4

Выполним на лидере Docker Swarm кластера команду: docker swarm update --autolock=true
